<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>附駕接送服務 | GOTO Rent</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        :root {
            --bs-primary-rgb: 40, 167, 69;
        }

        body {
            padding-top: 76px;
            background-color: #f4f7f9;
        }

        /* 選車卡片樣式 (Radio Button) */
        .car-select-label {
            cursor: pointer;
            width: 100%;
            transition: 0.2s;
            border: 2px solid transparent;
        }

        .car-select-input:checked+.car-select-label {
            border-color: var(--bs-primary);
            background-color: #f0fff4;
            transform: translateY(-3px);
        }

        .car-select-input {
            display: none;
        }

        /* 隱藏原始 Radio */

        /* 總金額區塊 */
        .total-price-box {
            background: #fff;
            border-top: 4px solid var(--bs-primary);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold fst-italic" href="index.html"><i class="bi bi-car-front-fill me-2"></i>GOTO
                Rent</a>
            <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span
                    class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">首頁</a></li>
                    <li class="nav-item"><a class="nav-link" href="subscription.html">訂閱車</a></li>
                    <li class="nav-item"><a class="nav-link active" href="chauffeur.html">附駕接送</a></li>
                    <li class="nav-item"><a class="nav-link" href="mambers.html">我的訂單</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container py-4">
        <h2 class="fw-bold mb-4 text-primary"><i class="bi bi-person-badge"></i> 專屬司機接送服務</h2>

        <div class="row g-4">
            <div class="col-lg-8">
                <form id="chauffeur-form" class="bg-white p-4 rounded shadow-sm">

                    <h5 class="border-bottom pb-2 mb-3 fw-bold">1. 選擇車款</h5>
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <input type="radio" name="carType" id="car1" class="car-select-input" value="camry"
                                data-base="1200" data-rate="25" checked>
                            <label for="car1" class="card p-3 car-select-label shadow-sm h-100">
                                <div class="d-flex justify-content-between">
                                    <span class="fw-bold">Toyota Camry</span>
                                    <span class="badge bg-secondary">4人 / 2行李</span>
                                </div>
                                <div class="text-muted small mt-1">基礎費 $1200 + $25/km</div>
                            </label>
                        </div>
                        <div class="col-md-6">
                            <input type="radio" name="carType" id="car2" class="car-select-input" value="staria"
                                data-base="1200" data-rate="25">
                            <label for="car2" class="card p-3 car-select-label shadow-sm h-100">
                                <div class="d-flex justify-content-between">
                                    <span class="fw-bold">Hyundai Staria</span>
                                    <span class="badge bg-secondary">8人 / 8行李</span>
                                </div>
                                <div class="text-muted small mt-1">基礎費 $1200 + $25/km</div>
                            </label>
                        </div>
                        <div class="col-md-6">
                            <input type="radio" name="carType" id="car3" class="car-select-input" value="alphard"
                                data-base="2200" data-rate="31">
                            <label for="car3" class="card p-3 car-select-label shadow-sm h-100">
                                <div class="d-flex justify-content-between">
                                    <span class="fw-bold">Toyota Alphard</span>
                                    <span class="badge bg-warning text-dark">豪華 4人</span>
                                </div>
                                <div class="text-muted small mt-1">基礎費 $2200 + $31/km</div>
                            </label>
                        </div>
                        <div class="col-md-6">
                            <input type="radio" name="carType" id="car4" class="car-select-input" value="lm"
                                data-base="3000" data-rate="34">
                            <label for="car4" class="card p-3 car-select-label shadow-sm h-100">
                                <div class="d-flex justify-content-between">
                                    <span class="fw-bold">Lexus LM</span>
                                    <span class="badge bg-dark">尊榮 4人</span>
                                </div>
                                <div class="text-muted small mt-1">基礎費 $3000 + $34/km</div>
                            </label>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mb-3 fw-bold">2. 行程資訊</h5>
                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label class="form-label">出發日期時間</label>
                            <input type="datetime-local" class="form-control" id="pickupTime" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">乘客人數</label>
                            <select class="form-select" id="passengerCount">
                                <option value="1">1人</option>
                                <option value="2">2人</option>
                                <option value="3">3人</option>
                                <option value="4">4人</option>
                                <option value="5">5人以上 (限休旅)</option>
                            </select>
                        </div>

                        <div class="col-12">
                            <label class="form-label">預估路程 (公里)</label>
                            <div class="input-group">
                                <select class="form-select" id="routeSelect">
                                    <option value="45">台北市區 -> 桃園機場 (約 45 km)</option>
                                    <option value="15">台北市區 -> 南港高鐵 (約 15 km)</option>
                                    <option value="60">台北市區 -> 新竹高鐵 (約 60 km)</option>
                                    <option value="0">自訂其他地點...</option>
                                </select>
                                <input type="number" class="form-control" id="customKm" placeholder="輸入公里數" value="45"
                                    readonly>
                                <span class="input-group-text">km</span>
                            </div>
                            <div class="form-text text-muted">※ 此處為模擬試算，實際公里數將由後端系統驗證。</div>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mb-3 fw-bold">3. 額外服務</h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" id="signService" value="200">
                        <label class="form-check-label" for="signService">
                            舉牌服務 (+ $200)
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="babySeat" value="300">
                        <label class="form-check-label" for="babySeat">
                            加購兒童座椅 (+ $300)
                        </label>
                    </div>
                </form>
            </div>

            <div class="col-lg-4">
                <div class="card shadow-sm border-0 sticky-top" style="top: 100px;">
                    <div class="card-header bg-dark text-white fw-bold">
                        費用試算
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                            <span>車款基礎費</span>
                            <span id="display-base">$1,200</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>里程費 (<span id="display-km">45</span> km)</span>
                            <span id="display-mileage">$1,125</span>
                        </div>
                        <div class="d-flex justify-content-between mb-3 text-muted small">
                            <span>額外服務</span>
                            <span id="display-extra">$0</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 fw-bold">預估總額</h5>
                            <h3 class="mb-0 text-danger fw-bold" id="display-total">$2,325</h3>
                        </div>

                        <button class="btn btn-primary w-100 mt-4 py-2 fw-bold" id="submitOrderBtn">
                            確認預訂
                        </button>
                        <p class="text-center mt-2 small text-muted">需先登入會員才能下單</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        $(document).ready(function () {

            // 1. 監聽所有會影響價格的欄位
            $('#chauffeur-form input, #chauffeur-form select').on('change input', calculatePrice);

            // 路線選擇邏輯 (切換 dropdown 自動填入公里數)
            $('#routeSelect').change(function () {
                const val = $(this).val();
                if (val === '0') {
                    $('#customKm').prop('readonly', false).val('').focus();
                } else {
                    $('#customKm').prop('readonly', true).val(val);
                }
                calculatePrice(); // 觸發重算
            });

            function calculatePrice() {
                // 取得選中的車型費率
                const selectedCar = $('input[name="carType"]:checked');
                const basePrice = parseInt(selectedCar.data('base'));
                const ratePerKm = parseInt(selectedCar.data('rate'));

                // 取得公里數
                let km = parseInt($('#customKm').val()) || 0;

                // 取得額外服務
                let extra = 0;
                if ($('#signService').is(':checked')) extra += 200;
                if ($('#babySeat').is(':checked')) extra += 300;

                // 計算
                const mileagePrice = km * ratePerKm;
                const total = basePrice + mileagePrice + extra;

                // 更新 UI
                $('#display-base').text('$' + basePrice.toLocaleString());
                $('#display-km').text(km);
                $('#display-mileage').text('$' + mileagePrice.toLocaleString());
                $('#display-extra').text('$' + extra.toLocaleString());
                $('#display-total').text('$' + total.toLocaleString());
            }

            // 模擬下單
            $('#submitOrderBtn').click(function () {
                const selectedCarName = $('input[name="carType"]:checked').next().find('.fw-bold').text();
                const total = $('#display-total').text();
                const date = $('#pickupTime').val();

                if (!date) {
                    alert("請選擇出發時間！");
                    return;
                }

                alert(`訂單模擬成功！\n\n車型：${selectedCarName}\n總金額：${total}\n\n(前端展示用，後續請接 API)`);
            });

            // 初始化計算一次
            calculatePrice();
        });
    </script>
</body>

</html>